# :pushpin: Tumblbug Spring Security Project
> í¬ë¼ìš°ë“œ í€ë”© ì‚¬ì´íŠ¸ 'í…€ë¸”ë²…' - ê¸°ì¡´ jsp í”„ë¡œì íŠ¸ë¥¼ Spring Projectë¡œ ë³€í™˜í•˜ê³  Spring Security ë° ë§¤ë‹ˆì € ê¸°ëŠ¥ì„ ì¶”ê°€í•œ ëª¨ë¸ 2ë°©ì‹ ì›¹ì‚¬ì´íŠ¸ êµ¬í˜„ (ë§¤ë‹ˆì € ê¸°ëŠ¥ ì¶”ê°€)  </br>

### ğŸ’» ì´ì „ í”„ë¡œì íŠ¸ 

[Tumblbug JSP Project](https://github.com/Vida0822/Tumblbug_JSP_Project)

<br>


### ëª©ì°¨

*7~12ë²ˆì€ ì œê°€ ì§ì ‘ êµ¬í˜„í•œ ë¶€ë¶„ë§Œ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤

1. [ì œì‘ê¸°ê°„ & ì°¸ì—¬ì¸ì›](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#1-%EC%A0%9C%EC%9E%91-%EA%B8%B0%EA%B0%84--%EC%B0%B8%EC%97%AC-%EC%9D%B8%EC%9B%90)  <br>
2. [ì‚¬ìš© ê¸°ìˆ ](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#2-%EC%82%AC%EC%9A%A9-%EA%B8%B0%EC%88%A0)  <br>
3. [í”„ë¡œì íŠ¸ ê°œìš”](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#3-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B0%9C%EC%9A%94)<br>
4. [ìš”êµ¬ë¶„ì„ : User-Diagram](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#4-%EC%9A%94%EA%B5%AC%EB%B6%84%EC%84%9D--uml-diagram)  <br>
5. [DB ë³€ë™ì‚¬í•­](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#5-db-%EB%B3%80%EB%8F%99%EC%82%AC%ED%95%AD) <br>
6. [í•µì‹¬ ê¸°ëŠ¥ ì½”ë”©](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#6-%ED%95%B5%EC%8B%AC-%EA%B8%B0%EB%8A%A5-%EC%BD%94%EB%94%A9)   <br>
7. [Spring Security ì ìš©](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#7-spring-security-%EC%A0%81%EC%9A%A9)    <br>
8. [Spring Tiles ì ìš©](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#8-spring-tiles-%EC%A0%81%EC%9A%A9)  <br>
9. [í•µì‹¬ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#9-%ED%95%B5%EC%8B%AC-%ED%8A%B8%EB%9F%AC%EB%B8%94-%EC%8A%88%ED%8C%85)  <br>
10. [ê¸°íƒ€ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#10-%EA%B7%B8-%EC%99%B8-%ED%8A%B8%EB%9F%AC%EB%B8%94-%EC%8A%88%ED%8C%85)  <br>
11. [ì‹œì—° ì˜ìƒ](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#11-%EC%8B%9C%EC%97%B0-%EC%98%81%EC%83%81) <br>
12. [í”„ë¡œì íŠ¸ íšŒê³ ](https://github.com/Vida0822/Tumblbug_Spring-Security-Project#12-%ED%9A%8C%EA%B3%A0--%EB%8A%90%EB%82%80%EC%A0%90) <br>

</br></br>



## 1. ì œì‘ ê¸°ê°„ & ì°¸ì—¬ ì¸ì›
- ğŸ‘© ê°œì¸ í”„ë¡œì íŠ¸ <br>

- ğŸ“† 2023 6ì›” 21ì¼ ~ 7ì›” 11ì¼ (21ì¼)  <br>

</br>

## 2. ì‚¬ìš© ê¸°ìˆ 
#### `Back-end`
  - Java 11
  - Spring Framework 2.3
  - Spring Security
  - Maven
  - Oracle
  - Tomcat
    
#### `Front-end`
  - html/css
  - java script
  - jquery
    
#### `ë°°í¬ ë° í˜‘ì—… íˆ´`
  - GitHub
  - AWS


</br>



## 3. í”„ë¡œì íŠ¸ ê°œìš”

â€‹	ì´ í”„ë¡œì íŠ¸ëŠ” ì§€ë‚œ jsp í”„ë¡œì íŠ¸(ë§í¬)ì—ì„œ ê³ ì „ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•œ ì›¹ MVC íŒ¨í„´ì„ Spring legacy ê°œë°œí™˜ê²½ ì²´ì¬ë¡œ ì»¨ë²ŒíŒ…í•˜ëŠ” ì›¹ í”„ë¡œì íŠ¸ì´ë‹¤. ì¶”ê°€ëœ í•µì‹¬ ê¸°ëŠ¥ìœ¼ë¡  Spring Securityë¥¼ í™œìš©í•œ ì¸ì¦/ì¸ê°€ ê¸°ëŠ¥ê³¼ (ë¡œê·¸ì¸/íšŒì›ê°€ì…, í˜ì´ì§€ë³„ ì ‘ê·¼ê¶Œí•œ ì„¤ì • ë“±) ê´€ë¦¬ì í˜ì´ì§€ êµ¬í˜„ì´ë‹¤(í”„ë¡œì íŠ¸ ì‹¬ì‚¬ ê¸°ëŠ¥), Spring Tilesë¥¼ í™œìš©í•œ headerì™€ footerì˜ ë¶„ë¦¬ì´ë‹¤.

â€‹	Spring Bootë¥¼ ë³¸ê²©ì ìœ¼ë¡œ ê³µë¶€í•˜ê¸° ì „ ì›¹ ë° ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ê°œë°œí™˜ê²½ì„ ì§ì ‘ ì„¤ì •í•˜ë©° ê¸°ë°˜ì´ ë˜ëŠ” Spirng frameworkì˜ ë™ì‘ì›ë¦¬ì™€ êµ¬ì¡°ë¥¼ íŒŒì•…í•˜ê³  Spring Securityì„ í†µí•´ ì›¹ ì¸ê°€/ì¸ì¦ ê¸°ëŠ¥ì„ ì´í•´í•  ìˆ˜ ìˆëŠ” ê¸°íšŒê°€ ë˜ì—ˆë‹¤. 

 

<details>
<summary><b> ê°œë°œë‹¨ê³„ ë° ì¼ì • </b></summary>
<div markdown="1">

* 6ì›” 21ì¼ ~ 6ì›” 27ì¼ : ê°œë°œí™˜ê²½ êµ¬ì¶• ë° í”„ë¡œì íŠ¸ ì„¤ê³„ 
* 6ì›” 28ì¼ ~ 7ì›” 03ì¼ : ê¸°ì¡´ í”„ë¡œì íŠ¸ ì»¨ë²ŒíŒ…
* 7ì›” 04ì¼ ~ 7ì›” 07ì¼ : íšŒì›ê°€ì…/ë¡œê·¸ì¸ ê¸°ëŠ¥ + Spring Security ì ìš©
* 7ì›” 08ì¼ ~ 7ì›” 11ì¼ : ê´€ë¦¬ì ê¸°ëŠ¥ + spring security ì ìš© 

</div>
</details> 
    
</br>



## 4. ìš”êµ¬ë¶„ì„ : UML Diagram



#### ğŸ“Œ ê¸°ì¡´ í”„ë¡œì íŠ¸ ìš”êµ¬ë¶„ì„ 

<details>
<summary><b>User-Diagram í¼ì¹˜ê¸°</b></summary>
<div markdown="1">

![use-diagram drawio](https://github.com/Vida0822/Tumblbug_Spring-Security-Project/assets/132312673/2bf19cd3-0cf3-4db3-b223-845ee11ddbe6)

</div>
</details> 
<br><br>


#### ğŸ“Œ ë³€ë™ì‚¬í•­ : Spring security ì ìš© 

<details>
<summary><b>ë³€ë™ì‚¬í•­ í¼ì¹˜ê¸°</b></summary>
<div markdown="1">


![ìš”êµ¬ë¶„ì„](https://github.com/Vida0822/Tumblbug_Spring-Security-Project/assets/132312673/a58c8df0-f81c-4afc-9858-6001e208a297)




</div>
</details> 
<br><br>


## 5. DB ë³€ë™ì‚¬í•­ 

â€‹	Spring Securityì„ ì ìš©í•˜ê¸° ìœ„í•´ ê¸°ì¡´ì˜ db ì„¤ê³„ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í–ˆë‹¤. <br></br>



#### ğŸ“Œ ê¸°ì¡´ í”„ë¡œì íŠ¸ DB ì„¤ê³„

<details>
<summary><b>erd í¼ì¹˜ê¸°</b></summary>
<div markdown="1">

![erd](https://github.com/Vida0822/Tumblbug_Spring-Security-Project/assets/132312673/95469e2d-28b8-46c3-96a5-0ddd598e44e5)
</div>
</details> 
<br><br>

#### ğŸ“Œ ë³€ë™ì‚¬í•­ : Spring security ì ìš© 

<details>
<summary><b>ë³€ë™ì‚¬í•­ í¼ì¹˜ê¸°</b></summary>
<div markdown="1">

**âœ” íšŒì› í…Œì´ë¸”**

1. íŒ¨ìŠ¤ì›Œë“œ ì•”í˜¸í™” ìœ„í•´ m_password ì˜ ë°ì´í„°ê°’ ê¸¸ì´ ë³€ê²½ í•„ìš” :  ë„‰ë„‰í•˜ê²Œ varchar2(100)ìœ¼ë¡œ ìˆ˜ì •

```sql
ALTER TABLE member MODIFY m_password VARCHAR2(100);
```



2. member í…Œì´ë¸”ì˜ enabled ì»¬ëŸ¼ ì¶”ê°€

```sql
ALTER TABLE member
ADD ( enabled char(1) default '1' );
```



3. email ì¹¼ëŸ¼ì— ì œì•½ì¡°ê±´ ë¶€ì—¬

```sql
ALTER TABLE member ADD CONSTRAINT unique_email UNIQUE(m_email);
```

<br>

**âœ”ê¶Œí•œ í…Œì´ë¸”**
<br>
1. member_authorities í…Œì´ë¸” ìƒì„±

```sql
CREATE TABLE member_authorities(
   username varchar2(100) not null
   , authority varchar2(100) not null
   , constraint fk_member_authorities_username
      FOREIGN KEY(username)
      REFERENCES member(m_email)
);
```



2.  ë§¤ë‹ˆì €, ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬

```sql
INSERT INTO member_authorities VALUES ( 'hong@naver.com' , 'ROLE_MANAGER' );
INSERT INTO member_authorities VALUES ( 'hong@naver.com' , 'ROLE_ADMIN' );
// íšŒì› ì´ë©”ì¼, ê¶Œí•œ ê°’ ì£¼ë©´ ë©ë‹ˆë‹¤.
```


</div>
</details> 
<br><br>




## 6. í•µì‹¬ ê¸°ëŠ¥ ì½”ë”© 

<details>
<summary><b>ê¸°ì¡´ í”„ë¡œì íŠ¸ íë¦„ë„</b></summary>
<div markdown="1">
<br>
	
![ì „ì²´íë¦„](https://github.com/Vida0822/Tumblbug_Spring-Security-Project/assets/132312673/e6262c5b-821c-4f29-af34-01cd582a8dfd)
</div>
</details> 
<br>

<details>
<summary><b>ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ íë¦„ë„</b></summary>
<div markdown="1">
<br>
	
![ìŠ¤í”„ë§í”„ë¡œì íŠ¸ êµ¬ì¡°ì„¤ëª… drawio](https://github.com/Vida0822/Tumblbug_Spring-Security-Project/assets/132312673/8e99bd4e-e546-4874-a4cd-5ca807b00d00)

</div>
</details> 
<br>



#### 6.1. í”„ë¡œì íŠ¸ ì¡°íšŒí•˜ê¸° - <a href="https://github.com/Vida0822/Tumblbug_Spring-Security-Project/wiki/%EC%A3%BC%EC%9A%94-%EA%B8%B0%EB%8A%A5-%EC%86%8C%EA%B0%9C(%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%A1%B0%ED%9A%8C)" >ìƒì„¸ë³´ê¸° - WIKI ì´ë™</a>

- í”„ë¡œì íŠ¸ ëª©ë¡ë³´ê¸°
- í”„ë¡œì íŠ¸ ê²€ìƒ‰í•˜ê¸°
- í”„ë¡œì ìŠ¤ ìƒì„¸ë³´ê¸°

#### 6.2. í›„ì›í•˜ê¸° - <a href="https://github.com/Vida0822/Tumblbug_Spring-Security-Project/wiki/%EC%A3%BC%EC%9A%94-%EA%B8%B0%EB%8A%A5-%EC%86%8C%EA%B0%9C(%ED%9B%84%EC%9B%90%ED%95%98%EA%B8%B0)" >ìƒì„¸ë³´ê¸° - WIKI ì´ë™</a>

- í›„ì› ìš”ì²­
- í›„ì› ìŠ¹ì¸(ì„±ê³µ)

#### 6.3. í”„ë¡œì íŠ¸ ì˜¬ë¦¬ê¸° Page  - <a href="https://github.com/Vida0822/Tumblbug_Spring-Security-Project/wiki/%EC%A3%BC%EC%9A%94-%EA%B8%B0%EB%8A%A5-%EC%86%8C%EA%B0%9C(%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%98%AC%EB%A6%AC%EA%B8%B0)" >ìƒì„¸ë³´ê¸° - WIKI ì´ë™</a> 

- í”„ë¡œì íŠ¸ ìƒì„±í•˜ê¸°
- ìš”ê¸ˆì œ ì„ íƒ/ë³€ê²½
- ë‚´ê°€ë§Œë“  í”„ë¡œì íŠ¸ ì¡°íšŒ
- í”„ë¡œì íŠ¸ ì‚­ì œí•˜ê¸°

#### 6.4. í”„ë¡œì íŠ¸ ê´€ë¦¬í•˜ê¸° Page  - <a href="https://github.com/Vida0822/Tumblbug_Spring-Security-Project/wiki/%EC%A3%BC%EC%9A%94-%EA%B8%B0%EB%8A%A5-%EC%86%8C%EA%B0%9C(%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B4%80%EB%A6%AC%ED%95%98%EA%B8%B0)" >ìƒì„¸ë³´ê¸° - WIKI ì´ë™</a> 

- í”„ë¡œì íŠ¸ ê´€ë¦¬ í˜ì´ì§€
- ê¸°ë³¸ì •ë³´ ì‘ì„±
- í€ë”©ê³„íš ì‘ì„±
- ì„ ë¬¼êµ¬ì„±
- í”„ë¡œì íŠ¸ ê³„íš ì‘ì„±
- ì°½ì‘ì ì •ë³´ ì‘ì„±
- ì‹ ë¢°ì™€ ì•ˆì „ ì‘ì„±
- ì‹¬ì‚¬ ìš”ì²­
  

#### 6.5. ê´€ë¦¬ì Page   - <a href="https://github.com/Vida0822/Tumblbug_Spring-Security-Project/wiki/%EC%A3%BC%EC%9A%94-%EA%B8%B0%EB%8A%A5-%EC%86%8C%EA%B0%9C(%EA%B4%80%EB%A6%AC%EC%9E%90-Page)" >ìƒì„¸ë³´ê¸° - WIKI ì´ë™</a> 

- ìƒíƒœë³„ í”„ë¡œì íŠ¸ ëª©ë¡ ì¡°íšŒ (ì „ì²´, ìŠ¹ì¸ë¨, ë°˜ë ¤ë¨)
- í”„ë¡œì íŠ¸ ìŠ¹ì¸/ë°˜ë ¤ 


</br></br>

## 7. Spring Security ì ìš©

ì´ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ì€ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ë¥¼ ì ìš©í•œ ê¸°ëŠ¥ë“¤ì…ë‹ˆë‹¤.    

<details>
<summary><b>ì˜ì¡´ ì¶”ê°€ - pom.xml </b></summary>
<div markdown="1">

```xml
<dependency>
	<groupId>org.springframework.security</groupId>
	<artifactId>spring-security-web</artifactId>
	<version>${org.springframework-version}</version>
</dependency>

<dependency>
	<groupId>org.springframework.security</groupId>
	<artifactId>spring-security-config</artifactId>
	<version>${org.springframework-version}</version>
</dependency>

<dependency>
	<groupId>org.springframework.security</groupId>
	<artifactId>spring-security-core</artifactId>
	<version>${org.springframework-version}</version>
</dependency>

<!-- https://mvnrepository.com/artifact/org.springframework.security/spring-security-taglibs -->
<dependency>
	<groupId>org.springframework.security</groupId>
	<artifactId>spring-security-taglibs</artifactId>
	<version>${org.springframework-version}</version>
</dependency>
```



</div>
</details> 





<details>
<summary><b>í•µì‹¬ ê¸°ëŠ¥ ì„¤ëª… í¼ì¹˜ê¸°</b></summary>
<div markdown="1">

### 7.1. íšŒì›ê°€ì… 


### âœ”ï¸ íšŒì›ê°€ì… 

* íšŒì›ê°€ì… ìš”ì²­ ì‹œ ë§¤ê°œë³€ìˆ˜ë¡œ ë„˜ì–´ì˜¨ 'ì´ë¦„, ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸'ì„ ë°›ì•„ íšŒì›ê°€ì…ì— í•„ìš”í•œ ì •ë³´ë¥¼ ì •ë¦¬í•´ë‘” joinRequest ê°ì²´ ìƒì„±

* PasswordEncoderë¥¼ êµ¬í˜„í•œ BCryptPasswordEncoderë¥¼ ë¹ˆê°ì²´ë¡œ ìƒì„±í•´ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•”í˜¸í™”í•´ ì„œë²„ì—ì„œë„ í™•ì¸í•˜ì§€ ëª»í•˜ë„ë¡ ë³´ì•ˆ ê°•í™”

* Mapper íŒŒì¼ì— í”„ë¡œì‹œì €ë¥¼ í™œìš©í•´ íšŒì›ê°€ì… ë™ì‹œì— ROLE_USER (íšŒì›ê¶Œí•œ) ë¶€ì—¬ 

* íšŒì›ê°€ì… ì„±ê³µì‹œ ë©”ì¸í˜ì´ì§€ë¡œ ì´ë™

<details>
<summary>security-context.xml</summary>
<div markdown="1">

```xml
<bean id="bCryptPasswordEncoder"  class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder"></bean>	
```

</div>
</details> 

<details>
<summary>MemberController.java</summary>
<div markdown="1">

```java
@Setter(onMethod=@__({@Autowired}))
	private PasswordEncoder passwordEncoder;
	
// íšŒì›ê°€ì… POST ìš”ì²­
@PostMapping("/join.do")
public String join( JoinRequest joinRequest ) throws Exception{
		   
String pwd = joinRequest.getPassword(); 
	       
joinRequest.setPassword(this.passwordEncoder.encode(pwd));
	       
this.memberMapper.memberInsert(joinRequest);
//   this.memberMapper.payMethodInsert();
return "redirect:../tumblbug/main.do";

}
```



</div>
</details> 

<details>
<summary>memberMapper.xml</summary>
<div markdown="1">

```xml
<insert id="memberInsert" parameterType="map">
{CALL
 DECLARE
 BEGIN
     	INSERT into member(m_cd, m_email, m_password, m_name, M_url, M_privacy, m_message, m_up, m_pro, m_liked, m_follow, m_mk)
		VALUES ('MEM'||SEQ_MEMBER.NEXTVAL, #{email}, #{password}, #{name}, DBMS_RANDOM.STRING('L', 16), '1', '1', '1', '1', '1', '1', '0');
		INSERT INTO member_authorities VALUES ( #{email} , 'ROLE_USER' );
  END
}		
</insert>
```



</div>
</details> 

</br>



### 7.2. ë¡œê·¸ì¸ 

### âœ”ï¸ ë¡œê·¸ì¸ 

* ì‚¬ìš©ìê°€ post ë©”ì„œë“œë¡œ ë¡œê·¸ì¸ ìš”ì²­ì„ ë³´ë‚´ë©´ `authentication-manager`ì— ì •ì˜ëœ `authentication-provider`ë¥¼ í†µí•´ ì‚¬ìš©ì ì„œë¹„ìŠ¤(`customUserDetailsService`)ë¥¼ í˜¸ì¶œí•˜ì—¬ ì‚¬ìš©ì ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤. 
  * customUserDetailsServiceì—ì„œ ìë™ ìƒì„±ëœ Userê°ì²´ì˜ userNameì„ ì‚¬ìš©í•´ í•´ë‹¹ userNameìœ¼ë¡œ MemberMapperì˜ readí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ íšŒì›ì •ë³´ ì¡°íšŒ í›„ ê·¸ íšŒì›ì˜ userName, passwordì™¸ ë‹¤ë¥¸ ì •ë³´ë„ í•¨ê»˜ Member ê°ì²´ë¡œ ë°›ì•„ì˜´  
  * í•´ë‹¹ Member ê°ì²´ë¡œ CustomUser ê°ì²´ ìƒì„±ìì— ë„£ì–´ì¤Œ
  * CustomUser: Member ê°ì²´(íšŒì›ì •ë³´)ì™€ ê¶Œí•œ ì •ë³´(ë¦¬ìŠ¤íŠ¸)ë¥¼ ê°–ê³  ìˆëŠ” ê°ì²´ 
* ê°€ì ¸ì˜¨ ì‚¬ìš©ì ì •ë³´ì™€ ì…ë ¥ë°›ì€ ë¹„ë°€ë²ˆí˜¸ë¥¼ `password-encoder`(`bCryptPasswordEncoder`)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„êµí•©ë‹ˆë‹¤.
* ì¸ì¦ì— ì„±ê³µí•˜ë©´ Securityë¥¼ í™œìš©í•´ ì‚¬ìš©ì ì •ì˜ ë¡œê·¸ì¸ í˜ì´ì§€ ë“±ë¡ : login-pageì˜ ë¡œê·¸ì¸ ì„±ê³µì‹œ ì²˜ë¦¬í•  í•¸ë“¤ëŸ¬ë¡œ ì„¤ì •í•œ customLoginSuccessHandler í˜¸ì¶œ
  * customLoginSuccessHandler ì—ì„œ ì¸ì¦ë°›ì€ ì‚¬ìš©ìì˜ ê¶Œí•œ ì •ë³´ì— ë”°ë¼ ê°ê° ë‹¤ë¥¸ ìš”ì²­ urlë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì²˜ë¦¬
* ë¡œê·¸ì¸ ì‹¤íŒ¨ì‹œ error ë§¤ê°œë³€ìˆ˜ì™€ í•¨ê»˜ ë‹¤ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ 
  * í•´ë‹¹ ë§¤ê°œë³€ìˆ˜ ì „ë‹¬ ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ëœ login í˜ì´ì§€ì—ì„  ë¡œê·¸ì¸ ì‹¤íŒ¨ ì•Œë¦¼ì°½ ë„ì›€  
* ë¡œê·¸ì•„ì›ƒ ìƒíƒœë©´ ë¡œê·¸ì¸/íšŒì›ê°€ì… ë²„íŠ¼ì´, ë¡œê·¸ì¸ ìƒíƒœë©´ íšŒì›ì´ ì ‘ì†í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ê°€ì§€ í˜ì´ì§€ë“¤ì„ ëª¨ë“  í˜ì´ì§€ í—¤ë”ì— ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ êµ¬í˜„  



<details>
<summary>security-context.xml</summary>
<div markdown="1">

```xml
<!-- ì‹¤ì œ ì¸ì¦ì„ ì²˜ë¦¬í•˜ëŠ” ê°ì²´ -->
<security:authentication-manager> 
	<security:authentication-provider user-service-ref="customUserDetailsService"> 
			<security:password-encoder ref="bCryptPasswordEncoder" />
	</security:authentication-provider>
</security:authentication-manager> 

<!-- ì‚¬ìš©ì ì •ì˜ ë¡œê·¸ì¸ í˜ì´ì§€ ë“±ë¡ ì†ì„± : login-page  -->
<security:form-login 
       login-page="/tumblbug/login.do"
       authentication-success-handler-ref="customLoginSuccessHandler"	       
       authentication-failure-url="/tumblbug/login.do?error=true"
       />
```

</div>
</details> 



<details>
<summary>CustomUserDetailsService.java</summary>
<div markdown="1">

```java
@Component("customUserDetailsService")
@Log4j
public class CustomUserDetailsService implements UserDetailsService{

	
	@Setter(onMethod=@__({@Autowired}))
	private MemberMapper memberMapper;
	
	@Override
	public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
		log.warn("> Load User By UserName : " + username);
		
		// vo ê°ì²´ì—ëŠ”   íšŒì›ì •ë³´ + ê¶Œí•œì •ë³´(authList)
		Member vo  = this.memberMapper.read(username);
		log.warn("> Queiried by Member mapper : " + vo);
		
		// UserDetails    <- ë³€í™˜X                                 vo
		//                          User êµ¬í˜„ org.doit.ik.security.damin.CustomUser
		return vo == null ? null : new CustomUser(vo);
	}

}
```

</div>
</details> 



<details>
<summary>MemberMapper.xml</summary>
<div markdown="1">

```xml
      <!-- m_email, m_password, m_name, enabled,authority -->
       <select id="read"  resultMap="memberMap">
	        SELECT m_cd, m_email, m_password, m_name, enabled,authority
		    FROM member  m LEFT JOIN member_authorities auth ON m.m_email = auth.username
	        WHERE m_email = #{m_email} 
      </select>
```



</div>
</details> 



<details>
<summary>CustomUser.java</summary>
<div markdown="1">

 ```java
 @Getter
 public class CustomUser extends User {
 
 private static final long serialVersionUID = 8215844917794450806L;
 	
 	private Member member; // member í•„ë“œëª… ê¸°ì–µ
 
 	public CustomUser(String username, String password, Collection<? extends GrantedAuthority> authorities) {
 		super(username, password, authorities); 
 	}
 	
 	//                            íšŒì›ì •ë³´ + ê¶Œí•œì •ë³´(authList)
 	public CustomUser(Member vo) {
 		super(
 				  vo.getM_email()
 				, vo.getM_password()
 				 // List<AuthVO>  -> Collection<>
 				, vo.getAuthList().stream().map( auth->new SimpleGrantedAuthority( auth.getAuthority() ) ).collect( Collectors.toList() )
 			);
 		this.member = vo;
 	}
 
 }
 ```

</div>
</details> 



<details>
<summary>CustomLoginSuccessHandler</summary>
<div markdown="1">

```java
@Component("customLoginSuccessHandler")
@Log4j
public class CustomLoginSuccessHandler extends SavedRequestAwareAuthenticationSuccessHandler implements AuthenticationSuccessHandler{

	
	@Override
	public void onAuthenticationSuccess(
			HttpServletRequest request, 
			HttpServletResponse response,
			Authentication authentication //ì¸ì¦ë°›ì€ ì‚¬ìš©ìì˜ ì •ë³´(ê¶Œí•œ)
			) throws IOException, ServletException {
		log.warn("> Login Success...");
		
		
		List<String> roleNames = new ArrayList<String>();
		
		authentication.getAuthorities().forEach( auth ->  {
			roleNames.add(auth.getAuthority());
		});

		log.warn("> ROLE NAMES : " + roleNames );
		
		if ( roleNames.contains("ROLE_ADMIN")) {
			response.sendRedirect("/tumblbug/manager.do?pro_status=test");
			return;
		} else if( roleNames.contains("ROLE_MANAGER")){
			response.sendRedirect("/tumblbug/manager.do?pro_status=test");
			return;
		} 
			else if( roleNames.contains("ROLE_USER")){
			response.sendRedirect("/tumblbug/main.do");
			return;
		}else {
			response.sendRedirect("/tumblbug/main.do");
		} 
	}

}
```



</div>
</details> 

<details>
<summary>loginForm.jsp</summary>
<div markdown="1">

```jsp
<form action="/login" autocomplete="on" class="style__Form-mir8lt-4 cFNky" name="form" method="post">
   <!-- ì…ë ¥ ë°›ê¸° --> 
    
</form>

<c:if test="${  param.error  }">
	<script>
		alert("ë¡œê·¸ì¸ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”. ")
	</script>
</c:if>  
```

</div>
</details> 



<details>
<summary>header.jsp</summary>
<div markdown="1">

```jsp
<sec:authorize access="isAuthenticated()">
   <div class="style__UserButton-zxsodr-10 csOHNF" id="memberMenu">
		<!-- í”„ë¡œí•„ ì´ë¯¸ì§€ -->
		<div style="margin: 0; padding: 0"
			class="style__UserAvatar-zxsodr-8 bKpcjX">
				<span style="margin: 0; padding: 0"
					class="ProfileImg__StyledProfileImg-sc-1vio56c-0 gXKtKb"></span>
		</div>
		<!-- íšŒì›ì´ë¦„ **** ìˆ˜ì •í•´ì•¼í•¨  -->
		<div class="style__UserText-zxsodr-11 fXtfpK">
            <sec:authentication property="principal.member.m_name"/> 
       </div>
<%-- <div class="style__UserText-zxsodr-11 fXtfpK"> ${pinfo.member.m_name} </div>  --%>
								</div>
		<!-- íšŒì›ë©”ë‰´ -->
		<div class="SNB__Wrapper-wpjnaw-1 VIJCO">
				<div class="SNB__MenuList-wpjnaw-2 dBwYuQ">
					<div class="SNB__MenuItem-wpjnaw-3 fBfUv">í”„ë¡œí•„</div>
					<div class="SNB__MenuItem-wpjnaw-3 fBfUv">ì‘ì›ê¶Œ</div>
					<div class="SNB__MenuItemDivider-wpjnaw-4 Tzsws"></div>
					<div class="SNB__MenuItem-wpjnaw-3 fBfUv">í›„ì›í˜„í™©</div>
					<div class="SNB__MenuItem-wpjnaw-3 fBfUv">ê´€ì‹¬ í”„ë¡œì íŠ¸</div>
					<div class="SNB__MenuItem-wpjnaw-3 fBfUv">íŒ”ë¡œìš°</div>
					<div class="SNB__MenuItemDivider-wpjnaw-4 Tzsws"></div>
					<div class="SNB__MenuItem-wpjnaw-3 fBfUv">ì•Œë¦¼</div>
					<div class="SNB__MenuItem-wpjnaw-3 fBfUv">ë©”ì‹œì§€</div>	                        		</div>
        </div>
</sec:authorize>
<sec:authorize access="isAnonymous()">		
    <div class="style__UserText-zxsodr-11 fXtfpK" id="loginButton">ë¡œê·¸ì¸/íšŒì›ê°€ì…</div>
</sec:authorize>
```

</div>
</details> 



</br>



### 7.3. ë¡œê·¸ì•„ì›ƒ 

</br>


### 7.4. ì ‘ê·¼ ê¶Œí•œ ì„¤ì • 

*  css, js, imageëŠ” ì ‘ê·¼ ì œì–´ ëŒ€ìƒì´ ì•„ë‹ˆê¸°ì— ì´ëŸ¬í•œ í˜ì´ì§€ë¡œì˜ ìš”ì²­ì€ ë³´ì•ˆí•„í„° ì²´ì¸ì„ ì ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤
* í”„ë¡œì íŠ¸ í›„ì›í•˜ê¸°, ë§Œë“¤ê¸°ëŠ” ë¡œê·¸ì¸ í•´ì•¼í•œ(íšŒì› ê¶Œí•œì„ ê°€ì ¸ì•¼ë§Œ) ì ‘ì†í•  ìˆ˜ ìˆë„ë¡ ê¶Œí•œ ì„¤ì • 
* ê´€ë¦¬ì í˜ì´ì§€ëŠ” ê´€ë¦¬ì ê¶Œí•œì„ ê°€ì ¸ì•¼ë§Œ ì ‘ì†í•  ìˆ˜ ìˆë„ë¡ ê¶Œí•œ ì„¤ì • 
* ê¶Œí•œì„ ê°–ì§€ ëª»í•œ ì‚¬ìš©ìê°€ ê´€ë¦¬ì í˜ì´ì§€ë¡œ ì ‘ì†í•˜ë ¤í•˜ë©´ customAccessDeniedHandler í˜¸ì¶œ 
* customAccessDeniedHandler ë¥¼ í˜¸ì¶œí•˜ì—¬ 403 í˜ì´ì§€ ëŒ€ì‹  ë”°ë¡œ ì œì‘í•œ ì ‘ê·¼ ë¶ˆê°€ ì—ëŸ¬ í˜ì´ì§€ê°€ ëœ¨ë„ë¡í•¨



<details>
<summary>security-context.xml</summary>
<div markdown="1">

```xml
<!-- css, js, imageëŠ” ì ‘ê·¼ ì œì–´ ëŒ€ìƒì´ ì•„ë‹ˆê¸°ì— ì´ëŸ¬í•œ í˜ì´ì§€ë¡œì˜ ìš”ì²­ì€ ë³´ì•ˆí•„í„° ì²´ì¸ì„ ì ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ -->
<security:http pattern="/static/**" security="none"></security:http>	
	<security:http pattern="/design/**" security="none"></security:http>	
	<security:http pattern="/css/**" security="none" />	
	<security:http pattern="/js/**" security="none" />	 
	
	<security:http use-expressions="true"> 

		<security:csrf disabled="true"/>

		<!-- ì ‘ê·¼ê¶Œí•œ ì„¤ì • íƒœê·¸ --> 
	    <security:intercept-url pattern="/tumblbug/manager.do" access="hasRole('ROLE_MANAGER')"/>
		<security:intercept-url pattern="/tumblbug/makeProject.do" access="isAuthenticated()"/> 	
 	    <security:intercept-url pattern="/tumblbug/pay.do" access="isAuthenticated()"/> 
<!-- 	    <security:intercept-url pattern="/customer/noticeDel.htm" access="hasRole('ROLE_MANAGER')"/> -->
	    <security:intercept-url pattern="/**" access="permitAll"/>
		
		   <!-- ì—ëŸ¬ ë©”ì‹œì§€ ë³´ë‹¤ëŠ” ì ‘ê·¼ ê¸ˆì§€ì— ëŒ€í•œ íŠ¹ì • í˜ì´ì§€ë¡œ ì´ë™í•˜ë„ë¡ ì§€ì •
	    <security:access-denied-handler error-page="/common/accessError.do" />
	     -->
	     <security:access-denied-handler ref="customAccessDeniedHandler" />
```

</div>
</details> 



<details>
<summary>CustomAccessDeniedHandler.java</summary>
<div markdown="1">

```java
@Component("customAccessDeniedHandler")
@Log4j
public class CustomAccessDeniedHandler implements AccessDeniedHandler{

	@Override
	public void handle(HttpServletRequest request, HttpServletResponse response,
			AccessDeniedException accessDeniedException) throws IOException, ServletException { 
		log.error("> Access Denied Handler");
		log.error("> Redirect...");
		
		response.sendRedirect("/tumblbug/accessError.do");
		
	}
}
```

</div>
</details> 


</div>
</details>

</br>

## 8. Spring Tiles ì ìš©

 Spring Tilesë¥¼ í™œìš©í•˜ì—¬ ì£¼ìš” í˜ì´ì§€(ë©”ì¸ í˜ì´ì§€, ê²€ìƒ‰ í˜ì´ì§€, ìƒì„¸ í˜ì´ì§€)ì˜ headerì™€ footerë¥¼ í•œ jsp í˜ì´ì§€ì—ì„œ ì‘ì—…í•´ ì‚½ì…í–ˆìŠµë‹ˆë‹¤.

<details>
<summary><b>ì˜ì¡´ ì¶”ê°€: pom.xml</b></summary>
<div markdown="1">

```xml
<!-- Tiles -->
<dependency>
     <groupId>org.apache.tiles</groupId>
     <artifactId>tiles-extras</artifactId>
     <version>${org.apache.tiles-version}</version>
</dependency>
<dependency>
     <groupId>org.apache.tiles</groupId>
     <artifactId>tiles-core</artifactId>
     <version>${org.apache.tiles-version}</version>
</dependency>  
<dependency>
     <groupId>org.apache.tiles</groupId>
     <artifactId>tiles-servlet</artifactId>
     <version>${org.apache.tiles-version}</version>
</dependency>
<dependency>
     <groupId>org.apache.tiles</groupId>
     <artifactId>tiles-jsp</artifactId>
     <version>${org.apache.tiles-version}</version>
</dependency>
```

</div>
</details>

<details>
<summary><b>ì ìš© ì›ë¦¬ ì„¤ëª… í¼ì¹˜ê¸°</b></summary>
<div markdown="1">




### 8.1. ì¬ë£Œ ì¤€ë¹„: íƒ€ì¼ ì •ì˜ 

<details>
<summary>tiles.xml </summary>
<div markdown="1">

```xml
<!-- main.tiles -->
<definition name="main.tiles" template="/WEB-INF/views/inc/layoutMain.jsp"> <!--ë„í™”ì§€--> 
   <put-attribute name="header" value="/WEB-INF/views/inc/header.jsp"/> <!-- ë¬¼ê° 1 --> 
   <put-attribute name="content" value="/WEB-INF/views/tumblbug/main.jsp"/><!-- ë¬¼ê° 2 --> 
   <put-attribute name="footer" value="/WEB-INF/views/inc/footer.jsp"/> <!-- ë¬¼ê° 3 -->   
</definition>
     
<!-- search.tiles -->
<definition name="search.tiles" template="/WEB-INF/views/inc/layoutSearch.jsp">
    <put-attribute name="header" value="/WEB-INF/views/inc/header.jsp"/>
    <put-attribute name="content" value="/WEB-INF/views/tumblbug/search.jsp"/>
    <put-attribute name="footer" value="/WEB-INF/views/inc/footer.jsp"/>     
</definition>

<!-- view.tiles -->
<definition name="view.tiles" template="/WEB-INF/views/inc/layoutView.jsp">
   <put-attribute name="header" value="/WEB-INF/views/inc/header.jsp"/>
   <put-attribute name="content" value="/WEB-INF/views/tumblbug/view.jsp"/>
</definition>   
```

</div>
</details>

</br>


### 8.2. ê·¸ë¦¼ ê·¸ë¦¬ê¸°: í˜ì´ì§€ ì‘ì„± 

<details>
<summary>layoutMain.jsp (main.tiles)</summary>
<div markdown="1">

```xml
<body>
	<div id="react-view" class="tbb-only-ff">
	
    	<!-- header ìœ„ì¹˜ ì§€ì • -->
		<tiles:insertAttribute name="header"/>	 <!-- ê·¸ë¦¼ ê·¸ë¦¬ê¸° 1 --> 
    
		<div class="style__Container-sc-7of8vt-0 gmYOwM">
		<!-- content ìœ„ì¹˜ ì§€ì • --> 
			<tiles:insertAttribute name="content"/> <!-- ê·¸ë¦¼ ê·¸ë¦¬ê¸° 2 --> 
		
		<!-- footer ìœ„ì¹˜ ì§€ì • -->
			<tiles:insertAttribute name="footer"/> <!-- ê·¸ë¦¼ ê·¸ë¦¬ê¸° 3 --> 		
		</div>
	</div>	
</body>
```

</div>
</details>

</br>


### 8.3. ê·¸ë¦¼ ë¶ˆëŸ¬ì˜¤ê¸°: í˜ì´ì§€ í˜¸ì¶œ

<details>
<summary>ProjectController.java</summary>
<div markdown="1">

```java
@GetMapping("/main.do")
public String main(Model model) {
	log.info("> /main GET");
	List<ProjectCard> CardList = this.mainProjectService.getCardList();
	List<ProjectCard> popCardList = this.mainProjectService.getPopCardList();
	model.addAttribute("CardList", CardList);
	model.addAttribute("popCardList", popCardList);
		
	return "main.tiles"; // layoutMain.jsp í˜¸ì¶œ
}
```

</div>
</details>

</br>



</div>
</details>

</br>





## 9. í•µì‹¬ íŠ¸ëŸ¬ë¸” ìŠˆíŒ… 

<details>
<summary><b>  9.1.  íšŒì›ì •ë³´ ì¶œë ¥ë¬¸ì œ  </b></summary>
<div markdown="1">

#### 1. ë¬¸ì œ ìƒí™©

- User ê°ì²´ë¡œ íšŒì›ì •ë³´ë¥¼ ì¡°íšŒí•´ Member ê°ì²´ ìƒì„±, ì´ë¥¼ íšŒì›ì •ë³´ì™€ ê¶Œí•œì •ë³´ë¥¼ ê°€ì§„ CustomUser ê°ì²´ë¡œ ë³€í™˜í•´ ì„¸ì…˜ì— ë“±ë¡í•˜ëŠ” ì½”ë“œë¥¼ ì°¾ì•„ ì‚¬ìš© 

  * ìì„¸í•œ ì½”ë“œ ì„¤ëª…ì€ '7. Spring Security ì ìš©'ì— ê¸°ìˆ  

-  ë§ì€ íŒŒì¼ì„ ìˆ˜ì •í•´ ë‹¨ìˆœ êµ¬ê¸€ë§ìœ¼ë¡  ì›ì¸ íŒŒì•… í˜ë“¬ 

  => ì •í™•í•œ íë¦„ ë° ì½”ë“œ ë™ì‘ ì›ë¦¬ì— ëŒ€í•œ ì´í•´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì›ì¸ì„ ì°¾ì•„ì•¼ í•¨



#### 2. ì›ì¸ 

: ì˜ëª»ëœ ê°ì²´ ì°¸ì¡°

* í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ì •ìƒì ìœ¼ë¡œ ë¡œê·¸ì¸ì€ ë˜ì—ˆìœ¼ë‚˜ ì¶œë ¥ë¶€ë¶„ì— ë¬¸ì œê°€ ìˆì–´ íšŒì› ì •ë³´ê°€ ì¶œë ¥ë˜ì§€ ì•ŠìŒ í™•ì¸ 

- var ì†ì„±ì´ CustomUserê°€ ì•„ë‹Œ Authentication ê°ì²´ë¥¼ ê°€ë¥´ì¼°ê³ , í•´ë‹¹ ê°ì²´ì—” Member í”„ë¡œí¼í‹°ê°€ ì—†ì–´ ì˜¤ë¥˜ ë°œìƒ



* ##### ê¸°ì¡´ ì½”ë“œ


~~~jsp
<sec:authentication property="principal" var="pinfo"/>  ${pinfo.member.m_name} 
~~~



#### 3. í•´ê²° 

- sec íƒœê·¸ ë°–ì´ ì•ˆì¸ íƒœê·¸ ë‚´ì—ì„œ ì„¸ì…˜ì„ ì§ì ‘ ì°¸ì¡°í•˜ë„ë¡ ìˆ˜ì •



* ##### ê°œì„ ëœ ì½”ë“œ


~~~jsp
<sec:authentication property="principal.member.m_name"/>
~~~



#### 4. Learnedâ€¦

Springì€ í¸ë¦¬í•œ í”„ë ˆì„ì›Œí¬ì§€ë§Œ ì´ í¸ë¦¬í•¨ì€ ë¬¸ì œê°€ ë°œìƒí–ˆì„ ë•Œ ê°œë°œìê°€ ì–´ë–»ê²Œ ëŒ€ì²˜í•´ì•¼ í• ì§€ ëª¨ë¥´ê²Œ ë§Œë“¬ 

â–¶ ì—ëŸ¬ë©”ì„¸ì§€ êµ¬ê¸€ë§ë§Œìœ¼ë¡œëŠ” í”„ë ˆì„ì›Œí¬ë¥¼ ì œëŒ€ë¡œ í™œìš©í•  ìˆ˜ ì—†ìœ¼ë©°, ì´í•´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì ì ˆí•œ í•´ê²° ë°©ë²•ì„ ë„ì¶œí•´ì•¼í•¨ 


</div>
</details>

</br>


<details>
<summary><b> 9.2. Premature end of file ì—ëŸ¬   </b></summary>
<div markdown="1">

##### ë¬¸ì œ ìƒí™©

Spring Project ì§„í–‰ ì¤‘ WEB-INF í´ë” ë°–ì— ìˆëŠ” jsp íŒŒì¼ì„ ì‹¤í–‰í•´ë„ 404 ì—ëŸ¬ë¡œ í˜ì´ì§€ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ



#### 1. console í™•ì¸í•´ë³´ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ ë°œìƒ

```xml
Cause by: org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 39; Premature end of file
```

##### âœ” point 

* AXParseException 
* remature end of file



#### 2. ì—ëŸ¬ ì¢…ë¥˜

XMLì„ íŒŒì‹±í•˜ëŠ” ë°©ì‹ ì¤‘ í•˜ë‚˜ë¡œ XMLë¬¸ì„œë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì½ì–´ ë“¤ì´ë©´ì„œ ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ë°©ì‹,

xml íŒŒì¼ì„ ì½ì–´ë“¤ì´ëŠ” ê³¼ì •ì—ì„œ ë¬¸ì œê°€ ìˆìœ¼ë©´ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ì´ë‹¤. ì‰½ê²Œ ë§í•˜ë©´ xml ë¬¸ë²• ì˜¤ë¥˜!

ğŸ“Œ ì„œë²„ë¥¼ ê°”ë‹¤ì˜¤ì§€ ì•Šì€ publicWeb ì‹¤í–‰ì‹œì ì—ì„œ ì˜¤ë¥˜ê°€ ë‚˜ëŠ” ì´ìœ  



* **ìì£¼í•˜ëŠ” ì‹¤ìˆ˜**

1. ì„ ì–¸ë¶€ì— ê³µë°±ì´ ìˆê±°ë‚˜
2. ì˜ëª»ëœ ìœ„ì¹˜ì— ì£¼ì„ì´ ìˆê±°ë‚˜
3. ë¶€ë“±í˜¸ë¥¼ <> ë¡œ ì¸ì‹í–ˆê±°ë‚˜ => í•´ê²°ì±… : CDATA!!! :  ë°ì´í„° ìì²´ë¥¼ ê·¸ëƒ¥ ë¬¸ì ê·¸ëŒ€ë¡œ ë°›ì•„ë“¤ì´ëŠ” ê²ƒ
4. xml êµ¬ì„±ìš”ì†Œì˜ ìˆœì„œ ë° ìœ„ì¹˜ê°€ ì˜ëª»ë˜ì—ˆê±°ë‚˜

â€‹	ë“± ì •ë§ ë‹¤ì–‘í•œ ì´ìœ ë¡œ ë°œìƒí•˜ëŠ” ì—ëŸ¬



#### 3. ì›ì¸ ê·œëª…

: í•´ë‹¹ xml íŒŒì¼ì—

```xml
<xml version="1.0" encoding="UTF-8"?>
```

ë§Œ ì‘ì„±ë˜ìˆì–´ <!DOCTYPE> ê°€ ì—†ì–´  ì–´ë–¤ ë¬¸ì„œíƒ€ì…ì¸ì§€? ëª°ë¼ì„œ ìƒê¸°ëŠ” ë¬¸ì œì¸ì§€

ë§¤í•‘ì´ ì•ˆë˜ì„œ ìƒê¸°ëŠ” ë¬¸ì œì¸ì§€ ì •í™•íˆ íŒŒì•…ì€ ì•ˆë¨



#### 4. í•´ê²°

```xml
<xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="org.doit.ik.mapper.MemberMapper">
    
</mapper>
```

ë¡œ ìˆ˜ì •í•´ ê° ë§¤í¼íŒŒì¼ë“¤ ë§¤í•‘ ì‹œì¼œì£¼ë‹ˆ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë¨



#### 5. test

- MemberMapper ë¥¼ ProjectMapper ë¡œ ë°”ê¾¸ë‹ˆ ë˜ë‹¤ì‹œ 404 ì—ëŸ¬
- Mapper íŒŒì¼ ì¤‘ í•˜ë‚˜ ì§€ì›Œë„ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰



#### 6. Learnedâ€¦

ì´ë ‡ê²Œ ì •ë§ ì‚¬ì†Œí•œ, ë‹¤ì–‘í•œ ì›ì¸ìœ¼ë¡œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œëŠ” êµ¬ê¸€ë§ìœ¼ë¡œ ëª…í™•í•œ ì›ì¸ì„ íŒŒì•…í•˜ê¸° ì–´ë ¤ì›€

â†’ ì½”ë”©ì´ ì–¼ë§ˆë˜ì§€ ì•Šì€ ì‹œì ì—ì„  ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ì‹œì ë¶€í„° í•˜ë‚˜ì”© ì§„í–‰í•´ë‚˜ê°€ë©´ì„œ ì‹¤í–‰

â†’ ì•ˆë˜ëŠ” ë¶€ë¶„ ìºì¹˜í•´ ë¬¸ì œ í•´ê²°

â†’ ì• ì´ˆì— ì½”ë”©í•  ë•Œ ë¶€í„° ê³„ì† í…ŒìŠ¤íŠ¸ -> ì½”ë”© -> í…ŒìŠ¤íŠ¸ -> ì½”ë”©ì„ ë°˜ë³µ (ì¤‘ê°„ì¤‘ê°„ ê³„ì† í…ŒìŠ¤íŠ¸)

â†’ ë§Œì•½ ì½”ë”©ì´ ë§ì´ ì§„í–‰ëœ ìƒíƒœë¼ë©´.... ?

</div>
</details>

</br>




<details>
<summary><b>  9.3. ë¶€ì í•©í•œ ì—´ ìœ í˜• : 1111 ì—ëŸ¬  </b></summary>
<div markdown="1">
	
 

##### ë¬¸ì œ ìƒí™©

Spring Project ì§„í–‰ ì¤‘ íŠ¹ì • í”„ë¡œì íŠ¸ì˜ ìƒì„¸ì¡°íšŒ ìš”ì²­ ì¤‘ ì—ëŸ¬ ë°œìƒ 



#### 1. console í™•ì¸í•´ë³´ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ ë°œìƒ

```bash
MyBatisSystemException: nested exception is org.apache.ibatis.type.TypeException: Could not set parameters for mapping: ParameterMapping{property=â€™pro_cdâ€™, mode=IN, javaType=class java.lang.Object, jdbcType=null, numericScale=null, resultMapId=â€™nullâ€™, jdbcTypeName=â€™nullâ€™, expression=â€™nullâ€™}. Cause: org.apache.ibatis.type.TypeException: Error setting null for parameter #1 with JdbcType OTHER . Try setting a different JdbcType for this parameter or a different jdbcTypeForNull configuration property. Cause: java.sql.SQLException: ë¶€ì í•©í•œ ì—´ ìœ í˜•: 1111]ì„(ë¥¼) ë°œìƒì‹œì¼°ìŠµë‹ˆë‹¤.
```



#### 2. ì—ëŸ¬ ì¢…ë¥˜

- mybatis ì˜¤ë¥˜ , ì¦‰ mapper.xml ì— ë§¤ê°œë³€ìˆ˜ë¡œ ë“¤ì–´ì™€ì•¼í•  â€˜pro_cdâ€™ê°€ ë“¤ì–´ì˜¤ì§€ ì•Šì•„ ë°œìƒí•˜ëŠ” ë¬¸ì œ

  â–¶ parameterë¡œ ë“¤ì–´ì™€ì•¼ í•  ê°’ì´ ì•ˆë“¤ì–´ì™€ì„œ ì˜¤ë¥˜ê°€ ë°œìƒ

  

ğŸ“Œ **ê·¸ë ‡ë‹¤ë©´ ì–´ëŠ ì‹œì ë¶€í„° ë“¤ì–´ì˜¤ì§€ ì•ŠëŠ”ê±¸ê¹Œ?** 





#### 3. ì›ì¸ ê·œëª…

1. ì»¨íŠ¸ë¡¤ëŸ¬ (í•¸ë“¤ëŸ¬í•¨ìˆ˜) : ì»¨íŠ¸ë¡¤ëŸ¬ì˜ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ê¹Œì§„ ë¬´ì‚¬íˆ ë“¤ì–´ì˜´

![image-20230704142145504](https://github.com/Vida0822/Tumblbug_Spring-Security-Project/assets/132312673/388f7685-9c23-4ff8-a5c9-90e61af31f25)

2. ì„œë¹„ìŠ¤ : f5 ë²„íŠ¼ìœ¼ë¡œ í•¨ìˆ˜ ì•ˆìœ¼ë¡œ ë“¤ì–´ì˜´ => pro_cdê°’ ì˜ ì „ë‹¬ë˜ëŠ”ê±° í™•ì¸

![image-20230704142635411](https://github.com/Vida0822/Tumblbug_Spring-Security-Project/assets/132312673/cc5b1460-690c-4c11-8634-8e14881ccdbe)

* ë¬¸ì œ :  ì—¬ê¸°ì„œ thisëŠ” projectController.view() ë¥¼ ë‚˜íƒ€ë‚´ê¸° ë•Œë¬¸ì— ë°–ì— ì„ ì–¸ë˜ì–´ìˆëŠ” viewProjectServiceë¥¼ í˜¸ì¶œ í•  ìˆ˜ ì—†ìŒ

â–¶ this.viewProjectServiceë¥¼ viewProjectServiceë¡œ ìˆ˜ì •




3. ë§¤í¼

![image-20230704143911959](https://github.com/Vida0822/Tumblbug_Spring-Security-Project/assets/132312673/22beeccb-cceb-4936-8b02-aa8e4bb57806)

ì—¬ê¸°ì„œ f5ëˆ„ë¥´ë‹ˆê¹Œ ë‚´ê°€ ë”°ë¡œ ë§Œë“¤ì–´ì¤€ì  ì—†ëŠ” invoke ë€ í•¨ìˆ˜ë¡œ ë“¤ì–´ê°
![image-20230704144330610](https://github.com/Vida0822/Tumblbug_Spring-Security-Project/assets/132312673/0d6d9162-7673-47d4-a401-feccbb80623f)


â–¶  ì¦‰ projectMapper ì¸í„°í˜ì´ìŠ¤ ì•ˆê¹Œì§„ ì •ìƒì ìœ¼ë¡œ ë“¤ì–´ê°”ìœ¼ë‹ˆ ë‚¨ì€ê±´ Mapper.xml ë¬¸ì œ

â–¶  ë””ë²„ê¹…ì€ ìë°”ì½”ë“œê¹Œì§€ë§Œ í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì´í›„ì˜ xml íŒŒì¼ì€ ë¡œê·¸ì˜ ì—ëŸ¬ë©”ì„¸ì§€ ë³´ë©´ì„œ ìˆ˜ì •í•´ì•¼í•¨

- ë””ë²„ê¹…ì˜ ì˜ì˜ : ë¬¸ì œê°€ ì´í›„ ê³¼ì •ì˜  mapper.xml íŒŒì¼ì¸ê±¸ ì•Œ ìˆ˜ ìˆì—ˆìŒ




* ì›ì¸ ë°œê²¬

![image-20230704145908094](https://github.com/Vida0822/Tumblbug_Spring-Security-Project/assets/132312673/4d5729ec-1abc-4dcf-8fe8-a2973845f084)

mapper.xml íŒŒì¼ì— pro_cdê°€ ë§¤ê°œë³€ìˆ˜ë¡œ ë“¤ì–´ì™€ì•¼í•˜ëŠ”ë°

ê·¸ í•¨ìˆ˜ ì•ˆìœ¼ë¡œ pro_cdë¥¼ ì„¤ì •í•´ì£¼ì§€ ì•Šì•„ì„œ (+ë„˜ê²¨ì£¼ì§€ ì•Šì•„ì„œ) ë°œìƒí•˜ëŠ” ë¬¸ì œ !



#### 4. í•´ê²°

```java
return this.projectMapper.getProject(String pro_cd) ; 
```

í”„ë¡œì íŠ¸ ì½”ë“œë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë„£ë„ë¡ í•´ë‹¹ ë§¤í¼ í•¨ìˆ˜ ìˆ˜ì •  

=> í˜¸ì¶œë¶€ì¸ viewServiceImpl.java ì—ì„œ ë§¤ê°œë³€ìˆ˜ ì „ë‹¬ 



#### 5. Learned.... 

* ì½”ë“œê°€ ë³µì¡í•´ì§ˆ ìˆ˜ë¡ 'ë””ë²„ê¹…' ê¸°ëŠ¥ì„ ì˜ ë‹¤ë£¨ëŠ”ê²Œ ì¤‘ìš”í•´ì§ 
* ë§ì€ ì—°ìŠµ í•„ìš” 

</div>
</details>

</br>




## 10. ê·¸ ì™¸ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

<details>
<summary>ì´ë¯¸ì§€ ìŠ¬ë¼ì´ë“œ ì´ë¯¸ì§€ ê°œìˆ˜ ì¡°íšŒ ëª»í•¨ </summary>
<div markdown="1">

```jsp
<script>
var size = ${imageFiles}.size()
showSlides(0);
</script>                              
```


- ì›ì¸ : ìë°” ìŠ¤í¬ë¦½íŠ¸ì—ì„  el ì¸ì‹ ë¶ˆê°€ 
- í•´ê²°: ìŠ¤í¬ë¦½íŠ¸ ë¦¿ìœ¼ë¡œ ë„˜ì–´ì˜¨ ê°ì²´ ì°¸ì¡°  -  <%= ( (ArrayList)request.getAttribute("imageFiles") ).size()%>

</div>
</details>

<details>
<summary>í”„ë¡œì íŠ¸ ê²€ìƒ‰ ì˜¤ë¥˜</summary>
<div markdown="1">


  - ì‹¬ì‚¬ê°€ ì™„ë£Œë˜ì§€ ì•Šì€ í”„ë¡œì íŠ¸ë“¤ë„ ëª©ë¡ìœ¼ë¡œ í•¨ê»˜ ì¶œë ¥ë¨ 
  - í•´ê²°: DB ì¡°íšŒì‹œ í”„ë¡œì íŠ¸ ìƒíƒœê°€ 'ì§„í–‰ ì¤‘'ì¸ í”„ë¡œì íŠ¸ë§Œ ëª©ë¡ìœ¼ë¡œ ì¡°íšŒ 

```xml
<select id="selProject" resultType="org.doit.ik.domain.Project">
    <![CDATA[
            SELECT *
            FROM project
            WHERE PRO_STATUS = 'ì§„í–‰ì¤‘'
            ORDER BY TO_NUMBER(SUBSTR(pro_cd,4)) ASC
        ]]>
</select>
```

</div>
</details>

<details>
<summary>ë™ì¼í•œ ìë£Œí˜•ì˜ ë§¤ê°œë³€ìˆ˜ ì¸ì‹ë¶ˆê°€ </summary>
<div markdown="1">


  - Mapper íŒŒì¼ì—ì„œ ë™ì¼í•œ ìë£Œí˜•ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ìœ¼ë©´ ì˜¤ë¥˜ ë°œìƒ 
  - @Paramì„ ì‚¬ìš©í•´ ê° ë§¤ê°œë³€ìˆ˜ ì§€ì • 

```java
int examine(String pro_cd, String searchCondition);
int examine(@Param("pro_cd") String pro_cd, @Param("searchCondition") String searchCondition);
```

</div>
</details>

<details>
<summary> security:intercept-url ì˜ url ì„¤ì • ë¬¸ì œ </summary>
<div markdown="1">


  - ë¬¸ì œ : intercept-urlì€ ë§¤ê°œë³€ìˆ˜ë¥¼ í•¨ê»˜ ì§€ì •ì‹œ ì¸ì‹í•˜ì§€ ëª»í•¨ 

```xml
 <security:intercept-url pattern="/manager.do?pro_status=writing" access="hasRole('ROLE_ADMIN')"/>
```


  - í•´ê²° : ë§¤ê°œë³€ìˆ˜ ì‚­ì œ  

```xml
<security:intercept-url pattern="/tumblbug/manager.do" access="hasRole('ROLE_MANAGER')"/>
```

</div>
</details>
    

<details>
<summary> AccessDeniedHandler í˜¸ì¶œ ë¶ˆê°€ </summary>
<div markdown="1">


  ```java
    @GetMapping("/accessError.do")
    public String accessDenied(Model model, Authentication auth) throws Exception{
        log.info("> /common/accessEror.htm...Get") ; 
        model.addAttribute("msg", "Access Denied"); 
        return "/common/accessError" ;
    } // accessDenied 
  ```

  - ë‹¨ìˆœíˆ í•´ë‹¹ í•¸ë“¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ ì½”ë”©ì´ ì—†ì–´ ë¬¸ì œ ë°œìƒ 

</div>
</details>    

<details>
<summary> u íƒœê·¸ ì¸ì‹ ë¶ˆê°€ </summary>
<div markdown="1">


  - ê¸°ì¡´ jsp í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•œ u íƒœê·¸ ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ì—ì„  sec íƒœê·¸ë¡œ ìˆ˜ì •

</div>
</details>    

<details>
<summary> contextPath ê²½ë¡œ ì˜¤ë¥˜ </summary>
<div markdown="1">


  - ê¸°ì¡´ ì½”ë“œì˜ ì´ë¯¸ì§€ ë° ìš”ì²­ urlì—” contextPath ê°€ ìë™ ë¶€ì—¬ë˜ /tumblbugì´ ì•ì— ë¶™ìŒ 
  - í•´ê²° : íŒŒì¼ë“¤ì„ tumblbug í´ë” ì•ˆìœ¼ë¡œ ì´ë™ì‹œì¼œ ìš”ì²­ ê²½ë¡œ ë§ì¶°ì¤Œ  

</div>
</details>  


<details>
<summary> HTTP delete Requestì‹œ ê°œë°œìë„êµ¬ì˜ XHR(XMLHttpRequest )ì—ì„œ deleteìš”ì²­ì´ 2ë²ˆì”© ì°íˆëŠ” ì´ìœ </summary>
<div markdown="1">


  - When you try to send a XMLHttpRequest to a different domain than the page is hosted, you are violating the same-origin policy. However, this situation became somewhat common, many technics are introduced. CORS is one of them.

      In short, server that you are sending the DELETE request allows cross domain requests. In the process, there should be a **preflight** call and that is the **HTTP OPTION** call.

      So, you are having two responses for the **OPTION** and **DELETE** call.

      see [MDN page for CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS).

    - ì¶œì²˜ : [https://stackoverflow.com/questions/35808655/why-do-i-get-back-2-responses-of-200-and-204-when-using-an-ajax-call-to-delete-o](https://stackoverflow.com/questions/35808655/why-do-i-get-back-2-responses-of-200-and-204-when-using-an-ajax-call-to-delete-o)

</div>
</details> 


</br>

## 11. ì‹œì—° ì˜ìƒ
<br>
<img width="700" alt="ê²€ìƒ‰í•˜ê¸°" src="https://github.com/Vida0822/Tumblbug_Spring-Security-Project/assets/132312673/aa8c9f54-b0d2-4ce0-b325-2bbfb50f42df">
<div style="position:relative;width:fit-content;height:fit-content;">
<a style="position:absolute;top:20px;right:1rem;opacity:0.8;" href="https://clipchamp.com/watch/sT9uy08ILJa?utm_source=embed&utm_medium=embed&utm_campaign=watch">
ğŸ‘‰ ì˜ìƒë³´ê¸°
</a>

</div>
	
## 12. íšŒê³  / ëŠë‚€ì 

> [ê·¹ë³µ, ê·¸ë¦¬ê³  ì„±ì¥](https://vida0822.github.io/memory/MR_Tumblbug_SpringProject/)

> [ìŒìš©ì—ì„œì˜ ìŠì§€ëª»í•  6ê°œì›”- ì•„ì§ í—›í—›í•˜ì§€ë§Œ ì˜ì§€ë‚´ë³¼ê²Œ](https://blog.naver.com/sinhimin11/223174316267)
